<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 1.5px;
}

</style>
<body>
<script src="http://d3js.org/d3.v3.js"></script>
<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>


<table>
  <tr>
    <td>
      <select id="cluster_sel">
        <option value='c1'>cluster 1</option>
        <option value='c2'>cluster 2</option>
        <option value='c3'>cluster 3</option>
        <option value='c4'>cluster 4</option>
        <option value='c5'>cluster 5</option>
      </select>
    </td>
  </tr>
  <tr>
    <td>
      <div id="plot"></div>
    </td>
  </tr>
</table>

<script>
function AddPlot(data_path) {
  var margin = {top: 20, right: 80, bottom: 30, left: 50},
      width = 960 - margin.left - margin.right,
      height = 300 - margin.top - margin.bottom;
  
  var x = d3.scale.linear()
      .range([0, width]);
  
  var y = d3.scale.linear()
      .range([height, 0]);
  
  var color = d3.scale.category10();
  
  var xAxis = d3.svg.axis()
      .scale(x)
      .orient("bottom");
  
  var yAxis = d3.svg.axis()
      .scale(y)
      .orient("left");
  
  var line = d3.svg.line()
      .interpolate("basis")
      .x(function(d) { return x(d.index); })
      .y(function(d) { return y(d.value); });
  
  var svg = d3.select("#plot").append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
    .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      
  d3.text(data_path, function(text) {
    var rows = d3.csv.parseRows(text),
        male = [],
        female = [],
        data = [];
    for (var i=0, n = rows.length; i<n; i++) {
      var row = rows[i][0],
          v = row.split(" "),
          m = v[0],
          f = v[1];
      male.push({'index':i, 'value':parseInt(m)});
      female.push({'index':i, 'value':parseInt(f)});
    }
    data = [{'color':'blue', 'values':male},{'color':'red', 'values':female}];
    
    x.domain([0, n]);
    y.domain([0, 5]);
  
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis)
      .append("text")
        .attr("x", n)
        .style("text-anchor", "end")
        .text("Time Step");
  
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
      .append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", 6)
        .attr("dy", ".71em")
        .style("text-anchor", "end")
        .text("Affect Rate");
  
    var mline = svg.selectAll(".male")
        .data(data)
      .enter().append("g")
        .attr("class", "male");
  
    mline.append("path")
        .attr("class", "line")
        .attr("d", function(d) { console.log(d); return line(d.values); })
        .style("stroke", function(d) { return d.color; });
        
  });
}

var clusters = [['203','212','217','225'],
                ['204','205','208','209','210','211','214','215','219','224'],
                ['206','207','218','220','222','228','230'],
                ['200','202','213'],
                ['201','221','223','226','227','229']];
    
function AddClusterPlot(cidx) {
  var clst = clusters[cidx];
  for (var i=0,n=clst.length;i<n;i++) {
    AddPlot("data/c" + clst[i] + ".txt");
  }
}

$('document').ready(function(){
  AddPlot("data/c200.txt");
  AddPlot("data/c201.txt");
  $('#cluster_sel').change(function(){
    $( "#cluster_sel option:selected" ).each(function() {
      var sel = parseInt($( this ).val());
      $('#plot').empty();
      AddClusterPlot(sel)
    });
  });
});
</script>
